# AIè§†é¢‘åŠ©æ‰‹ (AI Video Assistant)

[![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://python.org)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Status](https://img.shields.io/badge/Status-Active-brightgreen.svg)]()

åŸºäºå¤šæ¨¡æ€æŠ€æœ¯çš„æ™ºèƒ½è§†é¢‘å†…å®¹åˆ†æç³»ç»Ÿï¼Œæ”¯æŒè§†é¢‘è½¬å†™ã€æ–‡æœ¬å¤„ç†ã€è¯­ä¹‰æ£€ç´¢å’Œæ™ºèƒ½é—®ç­”ã€‚

## ğŸŒŸ é¡¹ç›®ç‰¹è‰²

- **ğŸ¥ å…¨æµç¨‹è§†é¢‘å¤„ç†**ï¼šä»è§†é¢‘æ–‡ä»¶åˆ°ç»“æ„åŒ–æ–‡æœ¬çš„å®Œæ•´æµæ°´çº¿
- **ğŸ” åŒé‡æ£€ç´¢ç³»ç»Ÿ**ï¼šå‘é‡è¯­ä¹‰æ£€ç´¢ + BM25å…³é”®è¯æ£€ç´¢
- **ğŸŒ å¤šè¯­è¨€æ”¯æŒ**ï¼šæ”¯æŒ99ç§è¯­è¨€çš„è¯­éŸ³è¯†åˆ«å’Œæ–‡æœ¬ç¿»è¯‘
- **ğŸ“ æ™ºèƒ½æ–‡æœ¬å¤„ç†**ï¼šè‡ªåŠ¨æ¸…æ´—ã€åˆ†æ®µã€ç¿»è¯‘è½¬å†™ç»“æœ
- **âš¡ é«˜æ€§èƒ½æ£€ç´¢**ï¼šæ¯«ç§’çº§å“åº”ï¼Œæ”¯æŒå¤§è§„æ¨¡è§†é¢‘åº“æ£€ç´¢
- **ğŸ”§ æ¨¡å—åŒ–è®¾è®¡**ï¼šæ˜“äºæ‰©å±•å’Œå®šåˆ¶

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.10+
- FFmpeg (ç”¨äºéŸ³è§†é¢‘å¤„ç†)
- å¯é€‰ï¼šCUDAæ”¯æŒçš„GPU (ç”¨äºåŠ é€Ÿ)

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/1625353276/Video_Assistant.git
cd Video_Assistant
```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**
```bash
# ä½¿ç”¨conda (æ¨è)
conda create -n video_assistant python=3.10
conda activate video_assistant

# æˆ–ä½¿ç”¨venv
python -m venv video_assistant
source video_assistant/bin/activate  # Linux/Mac
video_assistant\Scripts\activate     # Windows
```

3. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

4. **å®‰è£…ç³»ç»Ÿä¾èµ–**
```bash
# Windows: ä¸‹è½½FFmpegå¹¶æ·»åŠ åˆ°PATH
# https://ffmpeg.org/download.html

# macOS
brew install ffmpeg

# Ubuntu/Debian
sudo apt update
sudo apt install ffmpeg
```

5. **å¯é€‰ï¼šå®‰è£…åˆ†è¯åº“ï¼ˆæå‡æ£€ç´¢æ•ˆæœï¼‰**
```bash
# ä¸­æ–‡åˆ†è¯
pip install jieba

# è‹±æ–‡åˆ†è¯
pip install nltk
python -c "import nltk; nltk.download('punkt'); nltk.download('stopwords')"
```

### åŸºæœ¬ä½¿ç”¨

1. **è§†é¢‘è½¬å†™**
```bash
# åŸºç¡€è½¬å†™
python main.py --video data/raw_videos/your_video.mp4

# æŒ‡å®šæ¨¡å‹å’Œè¾“å‡ºç›®å½•
python main.py --video data/raw_videos/your_video.mp4 --model small --output ./output
```

2. **æ–‡æœ¬å¤„ç†**
```python
from modules.text.text_cleaner import TextCleaner
from modules.text.segmenter import TextSegmenter
from modules.text.translator import TextTranslator

# æ–‡æœ¬æ¸…æ´—
cleaner = TextCleaner()
cleaned_text = cleaner.clean_text("å—¯ è¿™ä¸ª å°±æ˜¯ ä»Šå¤©çš„ å†…å®¹")

# æ–‡æœ¬åˆ†æ®µ
segmenter = TextSegmenter(max_tokens=400)
segments = segmenter.segment_by_sentences(long_text)

# æ–‡æœ¬ç¿»è¯‘
translator = TextTranslator()
result = translator.translate("æ·±åº¦å­¦ä¹ ", target_lang="en")
```

3. **å†…å®¹æ£€ç´¢**
```python
from modules.retrieval.vector_store import VectorStore
from modules.retrieval.bm25_retriever import BM25Retriever

# å‘é‡è¯­ä¹‰æ£€ç´¢
vector_store = VectorStore()
vector_store.add_documents(documents)
results = vector_store.search("æ™ºèƒ½æ‰‹æœºå®šä½åŸç†", top_k=5)

# BM25å…³é”®è¯æ£€ç´¢
bm25 = BM25Retriever()
bm25.add_documents(documents)
results = bm25.search("GPS å«æ˜Ÿ", top_k=5)
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
Video_Assistant/
â”œâ”€â”€ ğŸ“„ main.py                 # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ ğŸ“„ test_pipeline.py        # æµæ°´çº¿æµ‹è¯•
â”œâ”€â”€ ğŸ“„ requirements.txt        # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ ğŸ“ modules/                # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ ğŸ“ video/             # è§†é¢‘å¤„ç† âœ…
â”‚   â”‚   â”œâ”€â”€ video_loader.py
â”‚   â”‚   â””â”€â”€ audio_extractor.py
â”‚   â”œâ”€â”€ ğŸ“ speech/            # è¯­éŸ³è¯†åˆ« âœ…
â”‚   â”‚   â””â”€â”€ whisper_asr.py
â”‚   â”œâ”€â”€ ğŸ“ text/              # æ–‡æœ¬å¤„ç† âœ…
â”‚   â”‚   â”œâ”€â”€ text_cleaner.py   # æ–‡æœ¬æ¸…æ´—
â”‚   â”‚   â”œâ”€â”€ segmenter.py      # æ–‡æœ¬åˆ†æ®µ
â”‚   â”‚   â””â”€â”€ translator.py     # æ–‡æœ¬ç¿»è¯‘
â”‚   â”œâ”€â”€ ğŸ“ retrieval/         # æ£€ç´¢ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ vector_store.py   # å‘é‡å­˜å‚¨ âœ…
â”‚   â”‚   â”œâ”€â”€ bm25_retriever.py # BM25æ£€ç´¢ âœ…
â”‚   â”‚   â”œâ”€â”€ hybrid_retriever.py # æ··åˆæ£€ç´¢ â³
â”‚   â”‚   â””â”€â”€ multi_query.py    # å¤šæŸ¥è¯¢ç”Ÿæˆ âœ…
â”‚   â”œâ”€â”€ ğŸ“ qa/                # é—®ç­”ç³»ç»Ÿ â³
â”‚   â””â”€â”€ ğŸ“ utils/             # å·¥å…·æ¨¡å— âœ…
â”œâ”€â”€ ğŸ“ data/                  # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ raw_videos/        # åŸå§‹è§†é¢‘
â”‚   â””â”€â”€ ğŸ“ transcripts/       # è½¬å†™ç»“æœ
â”œâ”€â”€ ğŸ“ models/                # æ¨¡å‹ç¼“å­˜
â”œâ”€â”€ ğŸ“ tests/                 # æµ‹è¯•æ–‡ä»¶
â””â”€â”€ ğŸ“ deploy/                # éƒ¨ç½²ç›¸å…³ â³
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### è§†é¢‘å¤„ç†æµæ°´çº¿
```
è§†é¢‘æ–‡ä»¶ â†’ è§†é¢‘æ ¡éªŒ â†’ éŸ³é¢‘æå– â†’ è¯­éŸ³è¯†åˆ« â†’ å¤šæ ¼å¼è¾“å‡º
```

### æ–‡æœ¬å¤„ç†æµæ°´çº¿
```
åŸå§‹æ–‡æœ¬ â†’ å»é™¤å¡«å……è¯ â†’ æ–‡æœ¬åˆ†æ®µ â†’ å¤šè¯­è¨€ç¿»è¯‘ â†’ ç»“æœä¿å­˜
```

### æ™ºèƒ½æ£€ç´¢ç³»ç»Ÿ
```
ç”¨æˆ·æŸ¥è¯¢
    â†“
å¤šæŸ¥è¯¢ç”Ÿæˆ âœ…
    â†“ (æ‰©å±•å¤šæ ·åŒ–æŸ¥è¯¢)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‘é‡æ£€ç´¢      â”‚    BM25æ£€ç´¢     â”‚
â”‚ (è¯­ä¹‰ç›¸ä¼¼åº¦)    â”‚  (å…³é”®è¯åŒ¹é…)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
ç»“æœèåˆæ’åº
    â†“
ç²¾å‡†æ£€ç´¢ç»“æœ
```

### å¤šæŸ¥è¯¢ç”Ÿæˆå™¨
- **è§„åˆ™æ‰©å±•**: åŒä¹‰è¯æ›¿æ¢ã€é¢†åŸŸæœ¯è¯­æ˜ å°„ã€å¥å¼å˜åŒ–
- **æ¨¡å‹æ‰©å±•**: è¯­ä¹‰ç›¸ä¼¼æŸ¥è¯¢ã€å…³é”®è¯æ‰©å±•
- **æ™ºèƒ½æƒé‡**: è‡ªåŠ¨åˆ†é…å’Œå½’ä¸€åŒ–æŸ¥è¯¢æƒé‡
- **å¤šè¯­è¨€æ”¯æŒ**: ä¸­è‹±æ–‡æ··åˆæŸ¥è¯¢å¤„ç†

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| åŠŸèƒ½æ¨¡å— | å¤„ç†é€Ÿåº¦ | å‡†ç¡®æ€§ | é€‚ç”¨åœºæ™¯ |
|---------|---------|--------|---------|
| Whisperè¯­éŸ³è¯†åˆ« | 0.5x-2xå®æ—¶ | 95%+ | å¤šè¯­è¨€è½¬å†™ |
| å‘é‡æ£€ç´¢ | ~6ms | è¯­ä¹‰åŒ¹é… | æ¦‚å¿µæŸ¥è¯¢ |
| BM25æ£€ç´¢ | ~1ms | ç²¾ç¡®åŒ¹é… | å…³é”®è¯æŸ¥è¯¢ |
| æ–‡æœ¬æ¸…æ´— | ~10ms | - | é¢„å¤„ç† |

## ğŸ› ï¸ æ¨¡å‹é…ç½®

### Whisperè¯­éŸ³è¯†åˆ«æ¨¡å‹
| æ¨¡å‹ | å¤§å° | é€Ÿåº¦ | å‡†ç¡®æ€§ | æ¨èåœºæ™¯ |
|------|------|------|--------|---------|
| tiny | 75MB | æœ€å¿« | åŸºç¡€ | å¿«é€Ÿæµ‹è¯• |
| base | 142MB | å¿«é€Ÿ | è‰¯å¥½ | æ—¥å¸¸ä½¿ç”¨ |
| small | 466MB | ä¸­ç­‰ | è¾ƒå¥½ | å¹³è¡¡é€‰æ‹© |
| medium | 1.5GB | è¾ƒæ…¢ | å¾ˆå¥½ | é«˜è´¨é‡éœ€æ±‚ |
| large | 2.9GB | æœ€æ…¢ | æœ€ä½³ | ä¸“ä¸šç”¨é€” |

### å‘é‡åŒ–æ¨¡å‹
- **é»˜è®¤**: sentence-transformers/all-MiniLM-L6-v2
- **ç»´åº¦**: 384ç»´
- **å¤§å°**: 90MB
- **ç‰¹ç‚¹**: è½»é‡çº§ï¼Œå¤šè¯­è¨€æ”¯æŒ

## ğŸ“ è¾“å‡ºæ ¼å¼

### JSONæ ¼å¼ï¼ˆæ¨èï¼‰
```json
{
  "audio_file": "video.mp4",
  "language": "zh",
  "text": "å®Œæ•´è½¬å†™æ–‡æœ¬...",
  "segments": [
    {
      "id": 0,
      "start": 0.0,
      "end": 5.2,
      "text": "ç¬¬ä¸€æ®µæ–‡æœ¬",
      "confidence": 0.95
    }
  ],
  "model_used": "base",
  "total_duration": 120.5,
  "avg_confidence": 0.92
}
```

### æ”¯æŒæ ¼å¼
- **JSON**: ç»“æ„åŒ–æ•°æ®ï¼ŒåŒ…å«æ—¶é—´æˆ³å’Œç½®ä¿¡åº¦
- **TXT**: çº¯æ–‡æœ¬æ ¼å¼ï¼Œæ˜“äºé˜…è¯»
- **SRT**: æ ‡å‡†å­—å¹•æ ¼å¼ï¼Œæ”¯æŒè§†é¢‘æ’­æ”¾å™¨
- **VTT**: Webè§†é¢‘å­—å¹•æ ¼å¼

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•
```bash
# åŸºç¡€æµæ°´çº¿æµ‹è¯•
python test_pipeline.py

# å‘é‡å­˜å‚¨æµ‹è¯•
python tests/test_vector_store.py

# BM25æ£€ç´¢å™¨æµ‹è¯•
python tests/test_bm25_retriever.py

# å¤šæŸ¥è¯¢ç”Ÿæˆå™¨æµ‹è¯•
python tests/test_multi_query.py

# æ£€ç´¢ç³»ç»Ÿé›†æˆæµ‹è¯•
python tests/test_retrieval_integration.py
```

### æµ‹è¯•è¦†ç›–
- âœ… è§†é¢‘å¤„ç†å’ŒéŸ³é¢‘æå–
- âœ… Whisperè¯­éŸ³è¯†åˆ«
- âœ… æ–‡æœ¬æ¸…æ´—å’Œåˆ†æ®µ
- âœ… æ–‡æœ¬ç¿»è¯‘
- âœ… å‘é‡å­˜å‚¨å’Œæ£€ç´¢
- âœ… BM25å…³é”®è¯æ£€ç´¢
- âœ… ç´¢å¼•æŒä¹…åŒ–

## ğŸ”„ å¼€å‘çŠ¶æ€

### âœ… å·²å®Œæˆ
- **è§†é¢‘å¤„ç†æ¨¡å—**: å®Œæ•´å®ç°å¹¶æµ‹è¯•
- **è¯­éŸ³è¯†åˆ«æ¨¡å—**: æ”¯æŒå¤šç§Whisperæ¨¡å‹
- **æ–‡æœ¬å¤„ç†æ¨¡å—**: æ¸…æ´—ã€åˆ†æ®µã€ç¿»è¯‘åŠŸèƒ½
- **å‘é‡å­˜å‚¨æ¨¡å—**: è¯­ä¹‰æ£€ç´¢å’Œç´¢å¼•ç®¡ç†
- **BM25æ£€ç´¢æ¨¡å—**: å…³é”®è¯åŒ¹é…å’Œè¯„åˆ†
- **å¤šæŸ¥è¯¢ç”Ÿæˆå™¨**: æŸ¥è¯¢æ‰©å±•å’Œå¤šæ ·åŒ– âœ¨
- **æ–‡ä»¶ç®¡ç†æ¨¡å—**: å¤šæ ¼å¼è¾“å‡ºæ”¯æŒ
- **åŸºç¡€æµ‹è¯•**: å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

### â³ å¼€å‘ä¸­
- **æ··åˆæ£€ç´¢å™¨**: å‘é‡å’ŒBM25ç»“æœèåˆ
- **é…ç½®ç³»ç»Ÿ**: æ¨¡å‹å’Œå‚æ•°é…ç½®
- **Webéƒ¨ç½²**: Flask APIæ¥å£

### ğŸ“‹ å¾…å¼€å‘
- **é—®ç­”ç³»ç»Ÿ**: åŸºäºæ£€ç´¢çš„æ™ºèƒ½é—®ç­”
- **ç”¨æˆ·ç•Œé¢**: Webå‰ç«¯ç•Œé¢
- **æ€§èƒ½ä¼˜åŒ–**: å¤§è§„æ¨¡æ•°æ®å¤„ç†
- **å¤šæ¨¡æ€èåˆ**: è§†é¢‘å†…å®¹ç†è§£

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### å¼€å‘è§„èŒƒ
- éµå¾ªPEP 8ä»£ç é£æ ¼
- æ·»åŠ è¯¦ç»†çš„æ–‡æ¡£å­—ç¬¦ä¸²
- ç¼–å†™å•å…ƒæµ‹è¯•
- æ›´æ–°ç›¸å…³æ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

